{{!-- templates/item/item-essence-sheet.hbs --}}
<form class="{{cssClass}}" autocomplete="off">

  {{> "systems/dungeon-stone/templates/item/parts/_item-header.hbs"}}

  {{!-- Ранг --}}
  <div class="essence-rank-display">{{system.rank}}</div>

  <nav class="sheet-tabs tabs" data-group="primary">
    <a class="item" data-tab="description">Описание</a>
    <a class="item" data-tab="properties">Свойства</a>
    <a class="item" data-tab="effects">Эффекты</a>
  </nav>

  <section class="sheet-body">

    <div class="tab description" data-group="primary" data-tab="description">
      <div class="editor-container">
        {{editor system.description target="system.description" button=true editable=editable engine="prosemirror" collaborate=false}}
      </div>
    </div>

    <div class="tab" data-group="primary" data-tab="properties">
      
      <div class="panel">
        <div class="panel-header"><i class="fas fa-star"></i> <h3>Активная способность</h3></div>
        
        <div class="rigid-grid">
          <div class="form-group full-row">
            <label>Название способности</label>
            <input type="text" name="system.abilityName" value="{{system.abilityName}}"/>
          </div>
          
          <div class="form-group">
            <label>Тип</label>
            <select name="system.abilityType" style="width:100%">
              <option value="damage" {{#if (eq system.abilityType "damage")}}selected{{/if}}>Урон</option>
              <option value="buff" {{#if (eq system.abilityType "buff")}}selected{{/if}}>Баф</option>
              <option value="utility" {{#if (eq system.abilityType "utility")}}selected{{/if}}>Утилита</option>
              <option value="transform" {{#if (eq system.abilityType "transform")}}selected{{/if}}>Трансформация</option>
            </select>
          </div>

          <div class="form-group">
            <label>Действие</label>
            <select name="system.activationAction" style="width:100%">
              <option value="action" {{#if (eq system.activationAction "action")}}selected{{/if}}>Действие</option>
              <option value="bonus" {{#if (eq system.activationAction "bonus")}}selected{{/if}}>Бонус</option>
              <option value="reaction" {{#if (eq system.activationAction "reaction")}}selected{{/if}}>Реакция</option>
              <option value="passive" {{#if (eq system.activationAction "passive")}}selected{{/if}}>Пассив</option>
            </select>
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-header"><i class="fas fa-coins"></i> <h3>Стоимость</h3></div>
        <div class="rigid-grid">
          <div class="form-group"><label>Мана</label><input type="number" name="system.manaCost" value="{{system.manaCost}}"/></div>
          <div class="form-group"><label>Дух</label><input type="number" name="system.spiritCost" value="{{system.spiritCost}}"/></div>
          <div class="form-group"><label>Кулдаун</label><input type="number" name="system.cooldown" value="{{system.cooldown}}"/></div>
          <div class="form-group inline"><label>На перезарядке</label><input type="checkbox" name="system.isOnCooldown" {{checked system.isOnCooldown}}/></div>
        </div>
      </div>

      {{#if (eq system.abilityType "damage")}}
      <div class="panel">
        <div class="panel-header"><i class="fas fa-burst"></i> <h3>Урон</h3></div>
        <div class="rigid-grid">
          <div class="form-group"><label>Формула</label><input type="text" name="system.damage" value="{{system.damage}}"/></div>
          <div class="form-group"><label>Тип</label><select name="system.damageType">{{selectOptions config.damageTypes selected=system.damageType}}</select></div>
        </div>
      </div>
      {{/if}}

    </div>

    {{> "systems/dungeon-stone/templates/item/parts/effects-tab.hbs"}}

  </section>
  
  {{#if isOwned}}
  <footer class="item-sheet-footer">
    <button type="button" class="essence-use-btn use-essence"><i class="fas fa-star"></i> Использовать</button>
  </footer>
  {{/if}}
</form>
